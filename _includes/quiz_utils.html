<style>
  .quiz-container {
    max-width: 600px;
    margin: 20px auto;
    padding: 20px;
    font-family: Arial, sans-serif;
  }

  /* Progress Bar Styles */
  .progress-container {
    margin-bottom: 30px;
  }

  .progress-bar {
    width: 100%;
    height: 20px;
    background-color: #e0e0e0;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #4CAF50, #45a049);
    border-radius: 10px;
    transition: width 0.3s ease;
    width: 0%;
  }

  .progress-text {
    text-align: center;
    font-weight: bold;
    color: #555;
    font-size: 14px;
  }

  /* Question Styles */
  .quiz-question {
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
  }

  .quiz-question h3 {
    margin-top: 0;
    color: #333;
  }

  .quiz-question label {
    display: flex;
    align-items: center;
    margin: 0.2em 0;
    padding: 0.4em;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }

  .quiz-question label:hover {
    background-color: #f0f0f0;
  }

  .quiz-question label input[type="radio"] {
    margin-right: 8px;
  }

  .quiz-question.disabled label {
    pointer-events: none;
    opacity: 0.6;
  }

  .quiz-question.disabled input[type="radio"] {
    pointer-events: none;
  }

  /* Button Styles */
  button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    margin-right: 10px;
    transition: background-color 0.2s ease;
  }

  button:hover {
    background-color: #0056b3;
  }

  .next-btn {
    background-color: #28a745;
  }

  .next-btn:hover {
    background-color: #1e7e34;
  }

  .retry-btn {
    background-color: #6c757d;
  }

  .retry-btn:hover {
    background-color: #545b62;
  }

  /* Results Styles */
  .quiz-results {
    background-color: #f8f9fa;
    border: 2px solid #007bff;
    border-radius: 10px;
    padding: 30px;
    text-align: center;
    max-width: 100%;
    word-wrap: break-word;
  }

  .quiz-results h3 {
    color: #007bff;
    margin-top: 0;
  }

  #finalScore {
    font-size: 16px;
    margin: 20px 0;
    padding: 20px;
    background-color: white;
    border-radius: 8px;
    border: 1px solid #ddd;
    text-align: left;
    line-height: 1.5;
    max-height: 400px;
    overflow-y: auto;
  }
</style>

<script>
// ============================================
// GOOGLE SPREADSHEET INFORMATION
// ============================================
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyTeDkaHgACI_vIbx2tJ-Tyi5UqYPxU3Y5YnXUW9jImq2QtudNVSoREP-NTwQyw-Eg/exec';

// ============================================
// QUIZ CONFIGURATION - ADD/REMOVE QUESTIONS HERE
// ============================================
const quizQuestions = [
  {
    question: "Báº¡n cÃ³ Ä‘á»ƒ Ã½ cÃ¡ch mÃ¬nh ngá»“i trong ngÃ y khÃ´ng?",
    options: [
      { text: "KhÃ´ng Ä‘á»ƒ Ã½ máº¥y, hoáº·c chÆ°a biáº¿t nÃ³ áº£nh hÆ°á»Ÿng Ä‘áº¿n viá»‡c sinh", score: 1 },
      { text: "CÅ©ng cÃ³ lÃºc Ä‘á»ƒ Ã½, lÃºc thÃ¬ quÃªn", score: 2 },
      { text: "CÃ³, mÃ¬nh cá»‘ gáº¯ng giá»¯ tÆ° tháº¿ tá»‘t má»—i ngÃ y", score: 3 }
    ]
  },
  {
    question: "Khi ngá»§, báº¡n thÆ°á»ng náº±m nghiÃªng bÃªn nÃ o?",
    options: [
      { text: "Náº±m ngá»­a hoáº·c tÆ° tháº¿ nÃ o tháº¥y dá»… ngá»§ lÃ  Ä‘Æ°á»£c", score: 1 },
      { text: "Thá»‰nh thoáº£ng nghiÃªng trÃ¡i", score: 2 },
      { text: "MÃ¬nh hay náº±m nghiÃªng trÃ¡i Ä‘á»ƒ giÃºp tuáº§n hoÃ n tá»‘t hÆ¡n", score: 3 }
    ]
  },
  {
    question: "Báº¡n Ä‘Ã£ tá»«ng thá»­ táº­p squat hoáº·c tÆ° tháº¿ â€œcÃ¡i bÃ nâ€ chÆ°a?",
    options: [
      { text: "ChÆ°a biáº¿t Ä‘Ã³ lÃ  gÃ¬ hoáº·c cÃ³ Ã­ch gÃ¬", score: 1 },
      { text: "CÃ³ nghe qua nhÆ°ng chÆ°a táº­p thÆ°á»ng xuyÃªn", score: 2 },
      { text: "CÃ³, mÃ¬nh táº­p 1â€“2 láº§n má»—i tuáº§n hoáº·c hÆ¡n", score: 3 }
    ]
  },
  {
    question: "Má»—i ngÃ y báº¡n cÃ³ di chuyá»ƒn nháº¹ nhÃ ng khÃ´ng?",
    options: [
      { text: "Chá»§ yáº¿u ngá»“i nhiá»u, Ã­t váº­n Ä‘á»™ng", score: 1 },
      { text: "Thá»‰nh thoáº£ng Ä‘i bá»™ hoáº·c váº­n Ä‘á»™ng nháº¹", score: 2 },
      { text: "Má»—i ngÃ y mÃ¬nh Ä‘á»u cÃ³ lÃºc Ä‘i bá»™ hoáº·c táº­p yoga nháº¹", score: 3 }
    ]
  },
  {
    question: "Khi tháº¥y cÄƒng tháº³ng hay Ä‘au nháº¹, báº¡n cÃ³ biáº¿t cÃ¡ch Ä‘á»ƒ cÆ¡ thá»ƒ tháº£ lá»ng láº¡i khÃ´ng?",
    options: [
      { text: "KhÃ´ng, mÃ¬nh thÆ°á»ng cá»©ng Ä‘Æ¡ cáº£ ngÆ°á»i", score: 1 },
      { text: "CÃ³ thá»ƒ tháº£ lá»ng má»™t pháº§n nhÆ° vai hay cá»•", score: 2 },
      { text: "CÃ³, mÃ¬nh táº­p trung tháº£ lá»ng cáº£ cÆ¡ thá»ƒ, Ä‘áº·c biá»‡t lÃ  bá»¥ng vÃ  máº·t", score: 3 }
    ]
  },
  {
    question: "Khi lo láº¯ng, báº¡n cÃ³ biáº¿t cÃ¡ch dÃ¹ng hÆ¡i thá»Ÿ Ä‘á»ƒ bÃ¬nh tÄ©nh láº¡i khÃ´ng?",
    options: [
      { text: "KhÃ´ng biáº¿t hoáº·c chÆ°a tá»«ng thá»­", score: 1 },
      { text: "CÃ³ biáº¿t nhÆ°ng chÆ°a quen dÃ¹ng", score: 2 },
      { text: "CÃ³, mÃ¬nh hay dÃ¹ng thá»Ÿ Ä‘á»ƒ xoa dá»‹u báº£n thÃ¢n", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ tá»«ng há»c ká»¹ thuáº­t thá»Ÿ cho tá»«ng giai Ä‘oáº¡n chuyá»ƒn dáº¡ chÆ°a?",
    options: [
      { text: "ChÆ°a nghe bao giá»", score: 1 },
      { text: "CÃ³ Ä‘á»c hoáº·c xem qua nhÆ°ng chÆ°a táº­p", score: 2 },
      { text: "CÃ³ há»c vÃ  thá»±c hÃ nh Ä‘á»u", score: 3 }
    ]
  },
  {
    question: "Báº¡n hiá»ƒu tá»›i Ä‘Ã¢u vá» cÃ¡c giai Ä‘oáº¡n cá»§a quÃ¡ trÃ¬nh sinh?",
    options: [
      { text: "ChÆ°a tÃ¬m hiá»ƒu ká»¹", score: 1 },
      { text: "Biáº¿t sÆ¡ sÆ¡ nhÆ°ng chÆ°a biáº¿t pháº£i lÃ m gÃ¬ tá»«ng giai Ä‘oáº¡n", score: 2 },
      { text: "MÃ¬nh hiá»ƒu rÃµ vÃ  biáº¿t mÃ¬nh sáº½ lÃ m gÃ¬ trong tá»«ng giai Ä‘oáº¡n", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ tá»«ng táº­p cÃ¡ch cáº£m nháº­n hoáº·c Ä‘iá»u khiá»ƒn cÆ¡ sÃ n cháº­u khÃ´ng?",
    options: [
      { text: "ChÆ°a bao giá» nghe tá»›i hoáº·c biáº¿t lÃ m sao táº­p", score: 1 },
      { text: "CÃ³ nghe nÃ³i nhÆ°ng khÃ´ng cháº¯c mÃ¬nh lÃ m Ä‘Ãºng", score: 2 },
      { text: "CÃ³, mÃ¬nh cáº£m nháº­n Ä‘Æ°á»£c rÃµ rÃ ng khi siáº¿t/tháº£", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ hay bá»‹ sÃ³n tiá»ƒu khi ho, háº¯t hÆ¡i hoáº·c cÆ°á»i to khÃ´ng?",
    options: [
      { text: "CÃ³, xáº£y ra khÃ¡ thÆ°á»ng xuyÃªn", score: 1 },
      { text: "Thá»‰nh thoáº£ng bá»‹", score: 2 },
      { text: "KhÃ´ng bá»‹", score: 3 }
    ]
  },
  {
    question: "Báº¡n Ä‘Ã£ tá»«ng tÃ¬m hiá»ƒu hoáº·c báº¯t Ä‘áº§u táº­p phá»¥c há»“i sÃ n cháº­u chÆ°a?",
    options: [
      { text: "ChÆ°a tá»«ng nghe Ä‘áº¿n", score: 1 },
      { text: "CÃ³ biáº¿t nhÆ°ng chÆ°a báº¯t Ä‘áº§u", score: 2 },
      { text: "CÃ³ rá»“i, mÃ¬nh Ä‘ang táº­p hoáº·c Ä‘Ã£ lÃªn káº¿ hoáº¡ch", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ biáº¿t tÆ° tháº¿ nÃ o giÃºp em bÃ© Ä‘i xuá»‘ng dá»… hÆ¡n khÃ´ng?",
    options: [
      { text: "ChÆ°a tÃ¬m hiá»ƒu", score: 1 },
      { text: "CÃ³ nghe nÃ³i vÃ i tÆ° tháº¿ nhÆ°ng chÆ°a quen táº­p", score: 2 },
      { text: "Biáº¿t rÃµ vÃ  Ä‘ang Ã¡p dá»¥ng nhÆ° Ä‘á»©ng tá»±a, nghiÃªng ngÆ°á»i, all fours...", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ tá»«ng táº­p tháº£ lá»ng vÃ¹ng Ã¢m Ä‘áº¡o vÃ  táº§ng sinh mÃ´n khÃ´ng?",
    options: [
      { text: "ChÆ°a biáº¿t cÃ³ thá»ƒ táº­p Ä‘iá»u nÃ y", score: 1 },
      { text: "CÃ³ nghe qua nhÆ°ng chÆ°a thá»±c hÃ nh Ä‘Æ°á»£c", score: 2 },
      { text: "CÃ³, mÃ¬nh Ä‘ang luyá»‡n táº­p vÃ  cáº£m nháº­n rÃµ", score: 3 }
    ]
  },
  {
    question: "Náº¿u ca sinh diá»…n ra khÃ´ng nhÆ° káº¿ hoáº¡ch, báº¡n sáº½...",
    options: [
      { text: "Ráº¥t lo láº¯ng, dá»… hoáº£ng", score: 1 },
      { text: "Lo nhÆ°ng sáº½ cá»‘ giá»¯ bÃ¬nh tÄ©nh", score: 2 },
      { text: "MÃ¬nh Ä‘Ã£ chuáº©n bá»‹ tinh tháº§n Ä‘á»ƒ linh hoáº¡t vÃ  á»©ng biáº¿n", score: 3 }
    ]
  },
  {
    question: "Khi nghÄ© Ä‘áº¿n sinh con, báº¡n cáº£m tháº¥y...",
    options: [
      { text: "Sá»£ vÃ  khÃ´ng tin mÃ¬nh lÃ m Ä‘Æ°á»£c", score: 1 },
      { text: "Lo nhÆ°ng váº«n cá»‘ nghÄ© tÃ­ch cá»±c", score: 2 },
      { text: "CÃ³ niá»m tin lÃ  mÃ¬nh sáº½ lÃ m Ä‘Æ°á»£c", score: 3 }
    ]
  },
  {
    question: "Báº¡n Ä‘Ã£ chuáº©n bá»‹ káº¿ hoáº¡ch sinh (birth plan) vÃ  nÃ³i chuyá»‡n vá»›i bÃ¡c sÄ© chÆ°a?",
    options: [
      { text: "ChÆ°a tá»«ng nghÄ© tá»›i hoáº·c chÆ°a tÃ¬m hiá»ƒu", score: 1 },
      { text: "CÃ³ Ã½ tÆ°á»Ÿng nhÆ°ng chÆ°a nÃ³i chuyá»‡n vá»›i ai", score: 2 },
      { text: "MÃ¬nh Ä‘Ã£ viáº¿t káº¿ hoáº¡ch vÃ  tháº£o luáº­n vá»›i bÃ¡c sÄ©/ná»¯ há»™ sinh", score: 3 }
    ]
  },
  {
    question: "Báº¡n Ä‘ang á»Ÿ tuáº§n thai thá»© máº¥y rá»“i?",
    options: [
      { text: "DÆ°á»›i 28 tuáº§n", score: 1 },
      { text: "28â€“36 tuáº§n", score: 2 },
      { text: "TrÃªn 36 tuáº§n", score: 3 }
    ]
  }
];

// ============================================
// QUIZ LOGIC - DON'T CHANGE BELOW THIS LINE
// ============================================
let currentQuestion = 0;
let totalQuestions = quizQuestions.length;
let totalScore = 0;
let answers = {};

function initializeQuiz() {
  currentQuestion = 0;
  totalScore = 0;
  answers = {};
  totalQuestions = quizQuestions.length;

  // Clear container
  document.getElementById('questionContainer').innerHTML = '';
  document.getElementById('results').style.display = 'none';

  // Generate all questions
  generateQuestions();

  // Show first question
  showQuestion(0);
  updateProgress();
}

function generateQuestions() {
  const container = document.getElementById('questionContainer');

  quizQuestions.forEach((q, index) => {
    const questionDiv = document.createElement('div');
    questionDiv.className = 'quiz-question';
    questionDiv.id = `question${index}`;
    questionDiv.style.display = 'none';

    let optionsHTML = '';
    q.options.forEach((option, optionIndex) => {
      optionsHTML += `
        <label>
          <input type="radio" name="q${index}" value="${optionIndex}" data-score="${option.score}"> ${option.text}
        </label>
      `;
    });

    questionDiv.innerHTML = `
      <h3>CÃ¢u ${index + 1}</h3>
      <p><strong>${q.question}</strong></p>
      <form>
        ${optionsHTML}
        <br>
        <button type="button" class="quiz-action-btn" onclick="handleQuizAction(this, ${index})">Gá»­i CÃ¢u Tráº£ Lá»i</button>
      </form>
      <p class="quiz-feedback" style="font-weight:bold;"></p>
    `;

    container.appendChild(questionDiv);
  });
}

function showQuestion(questionIndex) {
  // Hide all questions
  document.querySelectorAll('.quiz-question').forEach(q => {
    q.style.display = 'none';
  });

  // Show current question
  const currentQuestionDiv = document.getElementById(`question${questionIndex}`);
  if (currentQuestionDiv) {
    currentQuestionDiv.style.display = 'block';
  }
}

function updateProgress() {
  const progressFill = document.getElementById('progressFill');
  const progressText = document.getElementById('progressText');

  const progressPercentage = Math.round(((currentQuestion + 1) / totalQuestions) * 100);

  progressFill.style.width = progressPercentage + '%';
  progressText.textContent = `CÃ¢u ${currentQuestion + 1} / ${totalQuestions} (${progressPercentage}%)`;
}

function nextQuestion() {
  currentQuestion++;
  if (currentQuestion < totalQuestions) {
    showQuestion(currentQuestion);
    updateProgress();
  }
}

function handleQuizAction(button, questionIndex) {
  const questionDiv = button.closest('.quiz-question');
  const feedback = questionDiv.querySelector('.quiz-feedback');
  const isLastQuestion = questionIndex === quizQuestions.length - 1;
  const nextButtonText = isLastQuestion ? 'Xem Káº¿t Quáº£' : 'CÃ¢u Tiáº¿p Theo';

  if (button.dataset.state !== 'next') {
    // Submit answer logic
    const selectedInput = questionDiv.querySelector(`input[name="q${questionIndex}"]:checked`);
    if (!selectedInput) {
      feedback.textContent = 'Vui lÃ²ng chá»n má»™t cÃ¢u tráº£ lá»i trÆ°á»›c khi gá»­i.';
      feedback.style.color = '#721c24';
      return;
    }
    const userAnswerIndex = parseInt(selectedInput.value);
    const userScore = parseInt(selectedInput.dataset.score);

    answers[`q${questionIndex}`] = {
      selected: userAnswerIndex,
      score: userScore,
      question: quizQuestions[questionIndex].question,
      selectedText: quizQuestions[questionIndex].options[userAnswerIndex].text
    };
    totalScore += userScore;

    questionDiv.classList.add('disabled');
    button.textContent = nextButtonText;
    button.dataset.state = 'next';
    button.classList.add('next-btn');
  } else {
    // Next question or show results
    if (isLastQuestion) {
      showResults();
    } else {
      currentQuestion++;
      showQuestion(currentQuestion);
      updateProgress();
    }
  }
}

function submitAnswer(button, questionIndex) {
  const questionDiv = button.closest('.quiz-question');
  const selectedInput = questionDiv.querySelector(`input[name="q${questionIndex}"]:checked`);
  const feedback = questionDiv.querySelector('.quiz-feedback');
  const submitBtn = button;
  const nextBtn = questionDiv.querySelector('.next-btn');

  if (!selectedInput) {
    feedback.textContent = 'Vui lÃ²ng chá»n má»™t cÃ¢u tráº£ lá»i trÆ°á»›c khi gá»­i.';
    feedback.style.color = '#721c24';
    return;
  }

  const userAnswerIndex = parseInt(selectedInput.value);
  const userScore = parseInt(selectedInput.dataset.score);

  // Store the answer with score
  answers[`q${questionIndex}`] = {
    selected: userAnswerIndex,
    score: userScore,
    question: quizQuestions[questionIndex].question,
    selectedText: quizQuestions[questionIndex].options[userAnswerIndex].text
  };

  // Add to total score
  totalScore += userScore;

  // Disable radio buttons after submit
  questionDiv.classList.add('disabled');

  // Hide submit button and show next button
  submitBtn.style.display = 'none';
  nextBtn.style.display = 'inline-block';
}

function showResults() {
  // Hide current question
  document.querySelectorAll('.quiz-question').forEach(q => {
    q.style.display = 'none';
  });

  // Update progress to 100%
  const progressFill = document.getElementById('progressFill');
  const progressText = document.getElementById('progressText');
  progressFill.style.width = '100%';
  progressText.textContent = 'HoÃ n ThÃ nh! (100%)';

  // Show results with scoring message
  const resultsDiv = document.getElementById('results');
  const finalScore = document.getElementById('finalScore');

  // Determine message based on total score
  let scoreMessage = '';
  if (totalScore >= 44) {
    scoreMessage = `
      <strong>Báº¡n Ä‘ang ráº¥t gáº§n rá»“i â€“ hÃ£y tiáº¿p tá»¥c nuÃ´i dÆ°á»¡ng tráº¡ng thÃ¡i sáºµn sÃ ng nÃ y.</strong><br><br>
      CÆ¡ thá»ƒ báº¡n Ä‘ang pháº£n há»“i ráº¥t tá»‘t â€“ Ä‘iá»u Ä‘Ã³ cho tháº¥y báº¡n Ä‘Ã£ tÃ­ch lÅ©y Ä‘Æ°á»£c ná»n táº£ng á»•n Ä‘á»‹nh cáº£ vá» thá»ƒ cháº¥t vÃ  tinh tháº§n.<br><br>
      Äá»ƒ giÃºp báº¡n duy trÃ¬ sá»± sáºµn sÃ ng nÃ y, mÃ¬nh Ä‘Ã£ chuáº©n bá»‹ mini thá»­ thÃ¡ch 3 ngÃ y â€“ má»—i ngÃ y, báº¡n sáº½ nháº­n Ä‘Æ°á»£c má»™t video nhá» nhÆ°ng tinh gá»n:<br><br>
      <strong>NgÃ y 1:</strong> Audio 102 cÃ¢u nÃ³i tÃ­ch cá»±c â€“ dÃ nh nghe lÃºc nghá»‰ ngÆ¡i, hoáº·c lÃºc gÃ²<br>
      <strong>NgÃ y 2:</strong> 2 Ä‘á»™ng tÃ¡c giÃºp giá»¯ nhá»‹p váº­n Ä‘á»™ng vÃ  má»Ÿ hÃ´ng<br>
      <strong>NgÃ y 3:</strong> Gá»£i Ã½ Ä‘iá»u chá»‰nh nhá»‹p thá»Ÿ khi cÆ¡n gÃ² Ä‘áº¿n<br><br>
    `;
  } else if (totalScore >= 34 && totalScore < 44) {
    scoreMessage = `
      <strong>Báº¡n Ä‘ang á»Ÿ ngÃ£ ráº½ â€“ nÆ¡i chá»‰ cáº§n Ä‘iá»u chá»‰nh nháº¹, má»i thá»© sáº½ khá»›p láº¡i.</strong><br><br>
      Báº¡n Ä‘Ã£ cÃ³ má»™t sá»‘ ná»n táº£ng, nhÆ°ng cÆ¡ thá»ƒ váº«n Ä‘ang chá» báº¡n â€œgá»¡ má»™t nÃºt tháº¯t nhá»â€ â€“ cÃ³ thá»ƒ lÃ  tÆ° tháº¿, nhá»‹p thá»Ÿ hoáº·c tÃ¢m lÃ½ chÆ°a thá»±c sá»± tháº£ lá»ng.<br><br>
      MÃ¬nh Ä‘Ã£ chuáº©n bá»‹ cho báº¡n chuá»—i 3 ngÃ y káº¿t ná»‘i láº¡i â€“ giÃºp báº¡n soi rÃµ vÃ  Ä‘iá»u chá»‰nh nháº¹ tá»« nhá»¯ng gÃ¬ Ä‘ang cÃ³:<br><br>
      <strong>NgÃ y 1:</strong> Video "Ngá»“i Ä‘Ãºng â€“ Ä‘áº» nháº¹"<br>
      <strong>NgÃ y 2:</strong> Thá»Ÿ cháº­m â€“ cÃ¡ch Ä‘iá»u chá»‰nh khi cÆ¡n gÃ² Ä‘áº¿n<br>
      <strong>NgÃ y 3:</strong> Audio 102 cÃ¢u nÃ³i tÃ­ch cá»±c â€“ dÃ nh nghe lÃºc nghá»‰ ngÆ¡i, hoáº·c lÃºc gÃ²<br><br>
    `;
  } else if (totalScore >= 17 && totalScore < 34) {
    scoreMessage = `
      <strong>CÆ¡ thá»ƒ báº¡n Ä‘ang lÃªn tiáº¿ng â€“ vÃ  báº¡n cÃ³ thá»ƒ láº¯ng nghe ngay tá»« hÃ´m nay.</strong><br><br>
      Káº¿t quáº£ nÃ y khÃ´ng cÃ³ gÃ¬ sai â€“ nÃ³ chá»‰ nháº¯c ráº±ng: "MÃ¬nh cáº§n Ä‘Æ°á»£c quan tÃ¢m hÆ¡n má»™t chÃºt."<br><br>
      HÃ nh trÃ¬nh chuáº©n bá»‹ cho sinh ná»Ÿ báº¯t Ä‘áº§u tá»« nhá»¯ng viá»‡c ráº¥t Ä‘Æ¡n giáº£n â€“ khi báº¡n lÃ m Ä‘Ãºng chá»—, má»i thá»© sáº½ khá»›p láº¡i tá»± nhiÃªn.<br><br>
      Mini thá»­ thÃ¡ch 3 ngÃ y nÃ y lÃ  bÆ°á»›c Ä‘áº§u Ä‘á»ƒ báº¡n káº¿t ná»‘i láº¡i nháº¹ nhÃ ng:<br><br>
      <strong>NgÃ y 1:</strong> Video CÆ¡ sÃ n cháº­u 101 â€“ bÃ i táº­p ná»n Ä‘áº§u tiÃªn<br>
      <strong>NgÃ y 2:</strong> TÆ° tháº¿ ngá»“i tá»‘i Æ°u â€“ giÃºp bÃ© vÃ o vá»‹ trÃ­ dá»… sinh<br>
      <strong>NgÃ y 3:</strong> HÃ­t thá»Ÿ Ä‘Ãºng cÃ¡ch Ä‘á»ƒ bÃ¬nh tÄ©nh hÆ¡n má»—i ngÃ y<br><br>
    `;
  } else if (totalScore < 17) {
    scoreMessage = `
      <strong>ChÆ°a sáºµn sÃ ng khÃ´ng cÃ³ nghÄ©a lÃ  khÃ´ng thá»ƒ â€“ báº¡n chá»‰ Ä‘ang cáº§n má»™t Ä‘iá»ƒm báº¯t Ä‘áº§u Ä‘Ãºng Ä‘áº¯n.</strong><br><br>
      Náº¿u báº¡n cáº£m tháº¥y mÃ¬nh cÃ²n mÃ´ng lung â€“ Ä‘iá»u Ä‘Ã³ hoÃ n toÃ n bÃ¬nh thÆ°á»ng. Báº¡n Ä‘ang báº¯t Ä‘áº§u má»™t Ä‘iá»u má»›i, vÃ  Ä‘iá»u quan trá»ng lÃ : báº¡n Ä‘Ã£ dá»«ng láº¡i Ä‘á»ƒ láº¯ng nghe.<br><br>
      3 video trong 3 ngÃ y tá»›i sáº½ giÃºp báº¡n khá»Ÿi Ä‘á»™ng láº¡i, nháº¹ nhÃ ng mÃ  Ä‘á»§ sÃ¢u:<br><br>
      <strong>NgÃ y 1:</strong> HÃ­t thá»Ÿ 2 phÃºt â€“ Ä‘á»ƒ xoa dá»‹u vÃ  á»•n Ä‘á»‹nh láº¡i<br>
      <strong>NgÃ y 2:</strong> TÆ° tháº¿ ngá»“i â€“ cÃ¡ch Ä‘Æ¡n giáº£n nháº¥t Ä‘á»ƒ nÃ¢ng Ä‘á»¡ bÃ©<br>
      <strong>NgÃ y 3:</strong> CÆ¡ sÃ n cháº­u nháº¹ nhÃ ng â€“ vá»«a sá»©c, khÃ´ng Ã¡p lá»±c<br><br>
    `;
  }

  let endFinalMessage = `
    Äá»ƒ nháº­n Ä‘á»§ 3 video trong 3 ngÃ y tá»›i:<br><br>
    ğŸ‘‰ Äiá»n email cá»§a báº¡n vÃ o Ã´ bÃªn dÆ°á»›i â€“ HÃ£y Ä‘áº£m báº£o email Ä‘Ãºng Ä‘á»ƒ nháº­n Ä‘Æ°á»£c videos ğŸ’Œ<br><br>
    <input type="email" id="userEmail" placeholder="Nháº­p email cá»§a báº¡n..." style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px;">
    <div id="emailError" style="color: #721c24; font-size: 14px; margin: 5px 0; display: none;"></div>
    <button type="button" onclick="submitEmail()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 5px; font-weight: bold;">Gá»­i cho mÃ¬nh videos</button>
    <div id="emailSuccess" style="color: #155724; font-size: 14px; margin: 10px 0; display: none;">âœ… Email Ä‘Ã£ Ä‘Æ°á»£c ghi nháº­n thÃ nh cÃ´ng!</div>
  `;

  // Calculate max possible score dynamically
  const maxPossibleScore = quizQuestions.reduce((total, question) => {
    const maxScoreForQuestion = Math.max(...question.options.map(option => option.score));
    return total + maxScoreForQuestion;
  }, 0);

  // Calculate score as percentage
  const scorePercentage = Math.round((totalScore / maxPossibleScore) * 100);

  finalScore.innerHTML = `
    <h3>Káº¿t quáº£ Ä‘Ã¡nh giÃ¡: ${scorePercentage}%</h3>
    <div>${scoreMessage}</div>
    <div>${endFinalMessage}</div>
  `;

  resultsDiv.style.display = 'block';
}

async function sendResultsToGoogleSheets() {
  const maxPossibleScore = quizQuestions.reduce((total, question) => {
    const maxScoreForQuestion = Math.max(...question.options.map(option => option.score));
    return total + maxScoreForQuestion;
  }, 0);

  const resultsData = {
    timestamp: new Date().toISOString(),
    totalQuestions: totalQuestions,
    totalScore: totalScore,
    maxPossibleScore: maxPossibleScore,
    answers: answers || {}
  };

  try {
    const response = await fetch(GOOGLE_SCRIPT_URL, {
      redirect: 'follow',
      method: 'POST',
      headers: {
        'Content-Type': 'text/plain;charset=utf-8',
      },
      body: JSON.stringify(resultsData)
    });

    if (response.ok) {
      const result = await response.json();
      console.log('Success:', result);

      const statusDiv = document.createElement('div');
      statusDiv.innerHTML = 'âœ… Results successfully saved!';
      document.getElementById('results').appendChild(statusDiv);
    } else {
      throw new Error('Network response was not ok');
    }
  } catch (error) {
    console.error('Error:', error);
    // Handle error appropriately
  }
}

function retryQuiz() {
  initializeQuiz();
}

// Email validation and submission function
function submitEmail() {
  const emailInput = document.getElementById('userEmail');
  const emailError = document.getElementById('emailError');
  const emailSuccess = document.getElementById('emailSuccess');
  const email = emailInput.value.trim();

  // Hide previous messages
  emailError.style.display = 'none';
  emailSuccess.style.display = 'none';

  // Simple email validation regex
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  if (!email) {
    emailError.textContent = 'Vui lÃ²ng nháº­p email cá»§a báº¡n.';
    emailError.style.display = 'block';
    return;
  }

  if (!emailRegex.test(email)) {
    emailError.textContent = 'Vui lÃ²ng nháº­p má»™t Ä‘á»‹a chá»‰ email há»£p lá»‡.';
    emailError.style.display = 'block';
    return;
  }

  // Add email to answers object
  answers.userEmail = {
    email: email,
    submittedAt: new Date().toISOString()
  };

  // Show success message
  emailSuccess.style.display = 'block';

  // Disable the input and button
  emailInput.disabled = true;
  emailInput.style.backgroundColor = '#f8f9fa';
  const button = emailInput.nextElementSibling.nextElementSibling; // Get the button after error div
  button.disabled = true;
  button.textContent = 'ÄÃ£ ghi nháº­n email';
  button.style.backgroundColor = '#6c757d';

  console.log('Email recorded:', email);
  console.log('Updated answers:', answers);

  // Send results to Google Sheets
  sendResultsToGoogleSheets();
}

// Initialize quiz when page loads
window.addEventListener('load', initializeQuiz);
</script>
