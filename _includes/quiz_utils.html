<style>
  .quiz-container {
    max-width: 600px;
    margin: 20px auto;
    padding: 20px;
    font-family: Arial, sans-serif;
  }

  /* Progress Bar Styles */
  .progress-container {
    margin-bottom: 30px;
  }

  .progress-bar {
    width: 100%;
    height: 20px;
    background-color: #e0e0e0;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 10px;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #4CAF50, #45a049);
    border-radius: 10px;
    transition: width 0.3s ease;
    width: 0%;
  }

  .progress-text {
    text-align: center;
    font-weight: bold;
    color: #555;
    font-size: 14px;
  }

  /* Question Styles */
  .quiz-question {
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
  }

  .quiz-question h3 {
    margin-top: 0;
    color: #333;
  }

  .quiz-question label {
    display: flex;
    align-items: center;
    margin: 0.2em 0;
    padding: 0.4em;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }

  .quiz-question label:hover {
    background-color: #f0f0f0;
  }

  .quiz-question label input[type="radio"] {
    margin-right: 8px;
  }

  .quiz-question.disabled label {
    pointer-events: none;
    opacity: 0.6;
  }

  .quiz-question.disabled input[type="radio"] {
    pointer-events: none;
  }

  /* Button Styles */
  button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    margin-right: 10px;
    transition: background-color 0.2s ease;
  }

  button:hover {
    background-color: #0056b3;
  }

  .next-btn {
    background-color: #28a745;
  }

  .next-btn:hover {
    background-color: #1e7e34;
  }

  .retry-btn {
    background-color: #6c757d;
  }

  .retry-btn:hover {
    background-color: #545b62;
  }

  /* Results Styles */
  .quiz-results {
    background-color: #f8f9fa;
    border: 2px solid #007bff;
    border-radius: 10px;
    padding: 30px;
    text-align: center;
    max-width: 100%;
    word-wrap: break-word;
  }

  .quiz-results h3 {
    color: #007bff;
    margin-top: 0;
  }

  #finalScore {
    font-size: 16px;
    margin: 20px 0;
    padding: 20px;
    background-color: white;
    border-radius: 8px;
    border: 1px solid #ddd;
    text-align: left;
    line-height: 1.5;
    max-height: 400px;
    overflow-y: auto;
  }
</style>

<script>
// ============================================
// GOOGLE SPREADSHEET INFORMATION
// ============================================
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyTeDkaHgACI_vIbx2tJ-Tyi5UqYPxU3Y5YnXUW9jImq2QtudNVSoREP-NTwQyw-Eg/exec';

// ============================================
// QUIZ CONFIGURATION - ADD/REMOVE QUESTIONS HERE
// ============================================
const quizQuestions = [
  {
    question: "Báº¡n cÃ³ Ä‘á»ƒ Ã½ cÃ¡ch mÃ¬nh ngá»“i trong ngÃ y khÃ´ng?",
    options: [
      { text: "KhÃ´ng Ä‘á»ƒ Ã½ máº¥y, hoáº·c chÆ°a biáº¿t nÃ³ áº£nh hÆ°á»Ÿng Ä‘áº¿n viá»‡c sinh", score: 1 },
      { text: "CÅ©ng cÃ³ lÃºc Ä‘á»ƒ Ã½, lÃºc thÃ¬ quÃªn", score: 2 },
      { text: "CÃ³, mÃ¬nh cá»‘ gáº¯ng giá»¯ tÆ° tháº¿ tá»‘t má»—i ngÃ y", score: 3 }
    ]
  },
  {
    question: "Khi ngá»§, báº¡n thÆ°á»ng náº±m nghiÃªng bÃªn nÃ o?",
    options: [
      { text: "Náº±m ngá»­a hoáº·c tÆ° tháº¿ nÃ o tháº¥y dá»… ngá»§ lÃ  Ä‘Æ°á»£c", score: 1 },
      { text: "Thá»‰nh thoáº£ng nghiÃªng trÃ¡i", score: 2 },
      { text: "MÃ¬nh hay náº±m nghiÃªng trÃ¡i Ä‘á»ƒ giÃºp tuáº§n hoÃ n tá»‘t hÆ¡n", score: 3 }
    ]
  },
  {
    question: "Báº¡n Ä‘Ã£ tá»«ng thá»­ táº­p squat hoáº·c tÆ° tháº¿ â€œcÃ¡i bÃ nâ€ chÆ°a?",
    options: [
      { text: "ChÆ°a biáº¿t Ä‘Ã³ lÃ  gÃ¬ hoáº·c cÃ³ Ã­ch gÃ¬", score: 1 },
      { text: "CÃ³ nghe qua nhÆ°ng chÆ°a táº­p thÆ°á»ng xuyÃªn", score: 2 },
      { text: "CÃ³, mÃ¬nh táº­p 1â€“2 láº§n má»—i tuáº§n hoáº·c hÆ¡n", score: 3 }
    ]
  },
  {
    question: "Má»—i ngÃ y báº¡n cÃ³ di chuyá»ƒn nháº¹ nhÃ ng khÃ´ng?",
    options: [
      { text: "Chá»§ yáº¿u ngá»“i nhiá»u, Ã­t váº­n Ä‘á»™ng", score: 1 },
      { text: "Thá»‰nh thoáº£ng Ä‘i bá»™ hoáº·c váº­n Ä‘á»™ng nháº¹", score: 2 },
      { text: "Má»—i ngÃ y mÃ¬nh Ä‘á»u cÃ³ lÃºc Ä‘i bá»™ hoáº·c táº­p yoga nháº¹", score: 3 }
    ]
  },
  {
    question: "Khi tháº¥y cÄƒng tháº³ng hay Ä‘au nháº¹, báº¡n cÃ³ biáº¿t cÃ¡ch Ä‘á»ƒ cÆ¡ thá»ƒ tháº£ lá»ng láº¡i khÃ´ng?",
    options: [
      { text: "KhÃ´ng, mÃ¬nh thÆ°á»ng cá»©ng Ä‘Æ¡ cáº£ ngÆ°á»i", score: 1 },
      { text: "CÃ³ thá»ƒ tháº£ lá»ng má»™t pháº§n nhÆ° vai hay cá»•", score: 2 },
      { text: "CÃ³, mÃ¬nh táº­p trung tháº£ lá»ng cáº£ cÆ¡ thá»ƒ, Ä‘áº·c biá»‡t lÃ  bá»¥ng vÃ  máº·t", score: 3 }
    ]
  },
  {
    question: "Khi lo láº¯ng, báº¡n cÃ³ biáº¿t cÃ¡ch dÃ¹ng hÆ¡i thá»Ÿ Ä‘á»ƒ bÃ¬nh tÄ©nh láº¡i khÃ´ng?",
    options: [
      { text: "KhÃ´ng biáº¿t hoáº·c chÆ°a tá»«ng thá»­", score: 1 },
      { text: "CÃ³ biáº¿t nhÆ°ng chÆ°a quen dÃ¹ng", score: 2 },
      { text: "CÃ³, mÃ¬nh hay dÃ¹ng thá»Ÿ Ä‘á»ƒ xoa dá»‹u báº£n thÃ¢n", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ tá»«ng há»c ká»¹ thuáº­t thá»Ÿ cho tá»«ng giai Ä‘oáº¡n chuyá»ƒn dáº¡ chÆ°a?",
    options: [
      { text: "ChÆ°a nghe bao giá»", score: 1 },
      { text: "CÃ³ Ä‘á»c hoáº·c xem qua nhÆ°ng chÆ°a táº­p", score: 2 },
      { text: "CÃ³ há»c vÃ  thá»±c hÃ nh Ä‘á»u", score: 3 }
    ]
  },
  {
    question: "Báº¡n hiá»ƒu tá»›i Ä‘Ã¢u vá» cÃ¡c giai Ä‘oáº¡n cá»§a quÃ¡ trÃ¬nh sinh?",
    options: [
      { text: "ChÆ°a tÃ¬m hiá»ƒu ká»¹", score: 1 },
      { text: "Biáº¿t sÆ¡ sÆ¡ nhÆ°ng chÆ°a biáº¿t pháº£i lÃ m gÃ¬ tá»«ng giai Ä‘oáº¡n", score: 2 },
      { text: "MÃ¬nh hiá»ƒu rÃµ vÃ  biáº¿t mÃ¬nh sáº½ lÃ m gÃ¬ trong tá»«ng giai Ä‘oáº¡n", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ tá»«ng táº­p cÃ¡ch cáº£m nháº­n hoáº·c Ä‘iá»u khiá»ƒn cÆ¡ sÃ n cháº­u khÃ´ng?",
    options: [
      { text: "ChÆ°a bao giá» nghe tá»›i hoáº·c biáº¿t lÃ m sao táº­p", score: 1 },
      { text: "CÃ³ nghe nÃ³i nhÆ°ng khÃ´ng cháº¯c mÃ¬nh lÃ m Ä‘Ãºng", score: 2 },
      { text: "CÃ³, mÃ¬nh cáº£m nháº­n Ä‘Æ°á»£c rÃµ rÃ ng khi siáº¿t/tháº£", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ hay bá»‹ sÃ³n tiá»ƒu khi ho, háº¯t hÆ¡i hoáº·c cÆ°á»i to khÃ´ng?",
    options: [
      { text: "CÃ³, xáº£y ra khÃ¡ thÆ°á»ng xuyÃªn", score: 1 },
      { text: "Thá»‰nh thoáº£ng bá»‹", score: 2 },
      { text: "KhÃ´ng bá»‹", score: 3 }
    ]
  },
  {
    question: "Báº¡n Ä‘Ã£ tá»«ng tÃ¬m hiá»ƒu hoáº·c báº¯t Ä‘áº§u táº­p phá»¥c há»“i sÃ n cháº­u chÆ°a?",
    options: [
      { text: "ChÆ°a tá»«ng nghe Ä‘áº¿n", score: 1 },
      { text: "CÃ³ biáº¿t nhÆ°ng chÆ°a báº¯t Ä‘áº§u", score: 2 },
      { text: "CÃ³ rá»“i, mÃ¬nh Ä‘ang táº­p hoáº·c Ä‘Ã£ lÃªn káº¿ hoáº¡ch", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ biáº¿t tÆ° tháº¿ nÃ o giÃºp em bÃ© Ä‘i xuá»‘ng dá»… hÆ¡n khÃ´ng?",
    options: [
      { text: "ChÆ°a tÃ¬m hiá»ƒu", score: 1 },
      { text: "CÃ³ nghe nÃ³i vÃ i tÆ° tháº¿ nhÆ°ng chÆ°a quen táº­p", score: 2 },
      { text: "Biáº¿t rÃµ vÃ  Ä‘ang Ã¡p dá»¥ng nhÆ° Ä‘á»©ng tá»±a, nghiÃªng ngÆ°á»i, all fours...", score: 3 }
    ]
  },
  {
    question: "Báº¡n cÃ³ tá»«ng táº­p tháº£ lá»ng vÃ¹ng Ã¢m Ä‘áº¡o vÃ  táº§ng sinh mÃ´n khÃ´ng?",
    options: [
      { text: "ChÆ°a biáº¿t cÃ³ thá»ƒ táº­p Ä‘iá»u nÃ y", score: 1 },
      { text: "CÃ³ nghe qua nhÆ°ng chÆ°a thá»±c hÃ nh Ä‘Æ°á»£c", score: 2 },
      { text: "CÃ³, mÃ¬nh Ä‘ang luyá»‡n táº­p vÃ  cáº£m nháº­n rÃµ", score: 3 }
    ]
  },
  {
    question: "Náº¿u ca sinh diá»…n ra khÃ´ng nhÆ° káº¿ hoáº¡ch, báº¡n sáº½...",
    options: [
      { text: "Ráº¥t lo láº¯ng, dá»… hoáº£ng", score: 1 },
      { text: "Lo nhÆ°ng sáº½ cá»‘ giá»¯ bÃ¬nh tÄ©nh", score: 2 },
      { text: "MÃ¬nh Ä‘Ã£ chuáº©n bá»‹ tinh tháº§n Ä‘á»ƒ linh hoáº¡t vÃ  á»©ng biáº¿n", score: 3 }
    ]
  },
  {
    question: "Khi nghÄ© Ä‘áº¿n sinh con, báº¡n cáº£m tháº¥y...",
    options: [
      { text: "Sá»£ vÃ  khÃ´ng tin mÃ¬nh lÃ m Ä‘Æ°á»£c", score: 1 },
      { text: "Lo nhÆ°ng váº«n cá»‘ nghÄ© tÃ­ch cá»±c", score: 2 },
      { text: "CÃ³ niá»m tin lÃ  mÃ¬nh sáº½ lÃ m Ä‘Æ°á»£c", score: 3 }
    ]
  },
  {
    question: "Báº¡n Ä‘Ã£ chuáº©n bá»‹ káº¿ hoáº¡ch sinh (birth plan) vÃ  nÃ³i chuyá»‡n vá»›i bÃ¡c sÄ© chÆ°a?",
    options: [
      { text: "ChÆ°a tá»«ng nghÄ© tá»›i hoáº·c chÆ°a tÃ¬m hiá»ƒu", score: 1 },
      { text: "CÃ³ Ã½ tÆ°á»Ÿng nhÆ°ng chÆ°a nÃ³i chuyá»‡n vá»›i ai", score: 2 },
      { text: "MÃ¬nh Ä‘Ã£ viáº¿t káº¿ hoáº¡ch vÃ  tháº£o luáº­n vá»›i bÃ¡c sÄ©/ná»¯ há»™ sinh", score: 3 }
    ]
  },
  {
    question: "Báº¡n Ä‘ang á»Ÿ tuáº§n thai thá»© máº¥y rá»“i?",
    options: [
      { text: "DÆ°á»›i 28 tuáº§n", score: 1 },
      { text: "28â€“36 tuáº§n", score: 2 },
      { text: "TrÃªn 36 tuáº§n", score: 3 }
    ]
  }
];

// ============================================
// QUIZ LOGIC - DON'T CHANGE BELOW THIS LINE
// ============================================
let currentQuestion = 0;
let totalQuestions = quizQuestions.length;
let totalScore = 0;
let answers = {};

function initializeQuiz() {
  currentQuestion = 0;
  totalScore = 0;
  answers = {};
  totalQuestions = quizQuestions.length;

  // Clear container
  document.getElementById('questionContainer').innerHTML = '';
  document.getElementById('results').style.display = 'none';

  // Generate all questions
  generateQuestions();

  // Show first question
  showQuestion(0);
  updateProgress();
}

function generateQuestions() {
  const container = document.getElementById('questionContainer');

  quizQuestions.forEach((q, index) => {
    const questionDiv = document.createElement('div');
    questionDiv.className = 'quiz-question';
    questionDiv.id = `question${index}`;
    questionDiv.style.display = 'none';

    let optionsHTML = '';
    q.options.forEach((option, optionIndex) => {
      optionsHTML += `
        <label>
          <input type="radio" name="q${index}" value="${optionIndex}" data-score="${option.score}"> ${option.text}
        </label>
      `;
    });

    questionDiv.innerHTML = `
      <h3>CÃ¢u ${index + 1}</h3>
      <p><strong>${q.question}</strong></p>
      <form>
        ${optionsHTML}
        <br>
        <button type="button" class="quiz-action-btn" onclick="handleQuizAction(this, ${index})">Gá»­i CÃ¢u Tráº£ Lá»i</button>
      </form>
      <p class="quiz-feedback" style="font-weight:bold;"></p>
    `;

    container.appendChild(questionDiv);
  });
}

function showQuestion(questionIndex) {
  // Hide all questions
  document.querySelectorAll('.quiz-question').forEach(q => {
    q.style.display = 'none';
  });

  // Show current question
  const currentQuestionDiv = document.getElementById(`question${questionIndex}`);
  if (currentQuestionDiv) {
    currentQuestionDiv.style.display = 'block';
  }
}

function updateProgress() {
  const progressFill = document.getElementById('progressFill');
  const progressText = document.getElementById('progressText');

  const progressPercentage = Math.round(((currentQuestion + 1) / totalQuestions) * 100);

  progressFill.style.width = progressPercentage + '%';
  progressText.textContent = `CÃ¢u ${currentQuestion + 1} / ${totalQuestions} (${progressPercentage}%)`;
}

function handleQuizAction(button, questionIndex) {
  const questionDiv = button.closest('.quiz-question');
  const feedback = questionDiv.querySelector('.quiz-feedback');
  const isLastQuestion = questionIndex === quizQuestions.length - 1;
  const nextButtonText = isLastQuestion ? 'Xem Káº¿t Quáº£' : 'CÃ¢u Tiáº¿p Theo';

  // Check if user has selected an answer
  const selectedInput = questionDiv.querySelector(`input[name="q${questionIndex}"]:checked`);
  if (!selectedInput) {
    feedback.textContent = 'Vui lÃ²ng chá»n má»™t cÃ¢u tráº£ lá»i trÆ°á»›c khi gá»­i.';
    feedback.style.color = '#721c24';
    feedback.style.display = 'block';
    return;
  }

  // Clear any error message
  feedback.style.display = 'none';

  // Lock in the answer (disable all inputs for this question)
  const allInputs = questionDiv.querySelectorAll(`input[name="q${questionIndex}"]`);
  allInputs.forEach(input => {
    input.disabled = true;
  })

  // Store the answer
  const userAnswerIndex = parseInt(selectedInput.value);
  const userScore = parseInt(selectedInput.dataset.score);

  answers[`q${questionIndex}`] = {
    selected: userAnswerIndex,
    score: userScore,
    question: quizQuestions[questionIndex].question,
    selectedText: quizQuestions[questionIndex].options[userAnswerIndex].text
  };
  totalScore += userScore;

  // Disable the current question (visual feedback that it's locked)
  questionDiv.classList.add('disabled');

  // Move to next question or show results
  if (isLastQuestion) {
    showResults();
  } else {
    currentQuestion++;
    showQuestion(currentQuestion);
    updateProgress();
  }
}

function showResults() {
  // Hide current question
  document.querySelectorAll('.quiz-question').forEach(q => {
    q.style.display = 'none';
  });

  // Update progress to 100%
  const progressFill = document.getElementById('progressFill');
  const progressText = document.getElementById('progressText');
  progressFill.style.width = '100%';
  progressText.textContent = 'HoÃ n ThÃ nh! (100%)';

  // Show results with scoring message
  const resultsDiv = document.getElementById('results');
  const finalScore = document.getElementById('finalScore');

  // Determine message based on total score
  let scoreMessage = '';
  if (totalScore >= 44) {
    scoreMessage = `
      <strong>Báº¡n biáº¿t khÃ¡ rÃµ rá»“i â€“ vÃ  mÃ¬nh sáº½ giÃºp báº¡n nhÃ¬n toÃ n cáº£nh.</strong><br><br>
      Báº¡n cÃ³ váº» lÃ  ngÆ°á»i Ä‘á»c nhiá»u, há»c ká»¹, thá»±c hÃ nh tá»‘t, ráº¥t tá»‘t :) NhÆ°ng chÃ­nh vÃ¬ cÃ³ quÃ¡ nhiá»u lá»i khuyÃªn á»Ÿ YouTube, Facebook, bÃ¡o chÃ­, sÃ¡ch vá»Ÿ, nÃªn Ä‘Ã´i khi báº¡n láº¡i rÆ¡i vÃ o cáº£m giÃ¡c thiáº¿u Ä‘á»‹nh hÆ°á»›ng: nÃªn lÃ m cÃ¡i gÃ¬ â€“ lÃºc nÃ o â€“ vÃ  vÃ¬ sao. CÃ¡i báº¡n cáº§n khÃ´ng pháº£i thÃªm viá»‡c Ä‘á»ƒ lÃ m, mÃ  cÃ¡i thÃªm cÃ¡i nhÃ¬n tá»•ng quÃ¡t hÆ¡n.<br><br>
      <strong>ğŸ’¬ MÃ¬nh sáº½ giÃºp báº¡n</strong> nhÃ¬n láº¡i bá»©c tranh lá»›n â€“ vÃ  sáº¯p xáº¿p láº¡i cÃ¡c máº£nh ghÃ©p theo thá»© tá»± phÃ¹ há»£p vá»›i chÃ­nh báº¡n.<br><br>
    `;
  } else if (totalScore >= 34 && totalScore < 44) {
    scoreMessage = `
      <strong>Báº¡n Ä‘Ã£ cÃ³ ná»n táº£ng â€“ chá»‰ cáº§n ai Ä‘Ã³ Ä‘á»“ng hÃ nh thÃªm má»™t chÃºt.</strong><br><br>
      Báº¡n khÃ´ng cÃ²n xa láº¡ vá»›i khÃ¡i niá»‡m vá» sinh thÆ°á»ng, tÆ° tháº¿, hay hÆ¡i thá»Ÿ. CÃ³ thá»ƒ báº¡n Ä‘Ã£ báº¯t Ä‘áº§u táº­p, báº¯t Ä‘áº§u thá»Ÿ, báº¯t Ä‘áº§u tin mÃ¬nh cÃ³ thá»ƒ sinh tá»± nhiÃªn. NhÆ°ng Ä‘iá»u báº¡n cÃ²n thiáº¿u lÃ  sá»± Ä‘á»u Ä‘áº·n â€“ vÃ  má»™t ngÆ°á»i táº¡o thÃªm Ä‘á»™ng lá»±c Ä‘á»ƒ báº¡n khÃ´ng bá» cuá»™c giá»¯a chá»«ng.<br><br>
      <strong>ğŸ’¬ ÄÃ³ chÃ­nh lÃ  lÃ½ do</strong> mÃ¬nh thiáº¿t káº¿ hÃ nh trÃ¬nh Ä‘á»“ng hÃ nh nÃ y â€“ Ä‘á»ƒ báº¡n giá»¯ nhá»‹p, giá»¯ káº¿t ná»‘i vá»›i cÆ¡ thá»ƒ vÃ  hiá»ƒu cÆ¡ thá»ƒ sÃ¢u hÆ¡n. HÃ nh trÃ¬nh mang thai lÃ  1 hÃ nh trÃ¬nh cá»±c ká»³ thiÃªng liÃªng, trong Ä‘á»i chá»‰ cÃ³ vÃ i láº§n, hÃ£y táº­n dá»¥ng cÆ¡ há»™i Ä‘á»ƒ hiá»ƒu hÆ¡n vá» mÃ¬nh vÃ  cÆ¡ thá»ƒ mÃ¬nh nhÃ©.<br><br>
    `;
  } else if (totalScore >= 17 && totalScore < 34) {
    scoreMessage = `
      <strong>CÆ¡ thá»ƒ báº¡n Ä‘ang lÃªn tiáº¿ng â€“ vÃ  báº¡n Ä‘Ã£ báº¯t Ä‘áº§u biáº¿t láº¯ng nghe.</strong><br><br>
      Báº¡n cÃ³ thá»ƒ Ä‘Ã£ tá»«ng nghe Ä‘Ã¢u Ä‘Ã³ vá» cÆ¡ sÃ n cháº­u, hoáº·c xem video vá» hÆ¡i thá»Ÿ, nhÆ°ng váº«n tháº¥y hoang mang giá»¯a quÃ¡ nhiá»u luá»“ng thÃ´ng tin. Äiá»u khÃ³ nháº¥t khÃ´ng pháº£i lÃ  thiáº¿u kiáº¿n thá»©c, mÃ  lÃ  khÃ´ng biáº¿t cÃ¡i gÃ¬ thá»±c sá»± phÃ¹ há»£p vá»›i mÃ¬nh.<br><br>
      <strong>ğŸ’¬ MÃ¬nh hiá»ƒu.</strong> VÃ  mÃ¬nh muá»‘n giÃºp báº¡n lá»c bá»›t nhiá»…u, Ä‘á»ƒ tháº¥y rÃµ hÆ¡n Ä‘Ã¢u lÃ  Ä‘iá»u báº¡n nÃªn lÃ m ngay bÃ¢y giá», vÃ¬ thá»i gian chÃºng ta cÃ³ háº¡n. ChÃºng ta nÃªn táº­p nhá»¯ng gÃ¬ cáº§n vÃ  Ä‘á»§, thay vÃ¬ táº­p lung tung mÃ  khÃ´ng biáº¿t cÆ¡ thá»ƒ cáº§n hay khÃ´ng.<br><br>
    `;
  } else if (totalScore < 17) {
    scoreMessage = `
      <strong>Báº¡n chÆ°a sáºµn sÃ ng â€“ vÃ  Ä‘Ã³ chÃ­nh xÃ¡c lÃ½ do báº¡n Ä‘ang á»Ÿ Ä‘Ã¢y.</strong><br><br>
      Báº¡n Ä‘ang á»Ÿ Ä‘iá»ƒm xuáº¥t phÃ¡t â€“ nÆ¡i má»i thá»© váº«n cÃ²n ráº¥t má»›i máº»: tá»« tÆ° tháº¿ ngá»“i, hÆ¡i thá»Ÿ, cÆ¡ sÃ n cháº­u cho tá»›i viá»‡c phá»¥c há»“i sau sinh. CÃ³ thá»ƒ báº¡n chÆ°a tá»«ng Ä‘Æ°á»£c hÆ°á»›ng dáº«n cá»¥ thá»ƒ, hoáº·c Ä‘Æ¡n giáº£n lÃ  chÆ°a tá»«ng Ä‘Æ°á»£c ai giáº£i thÃ­ch cáº·n káº½.<br><br>
      <strong>ğŸ’¬ KhÃ´ng sao cáº£.</strong> HÃ nh trÃ¬nh nÃ o cÅ©ng báº¯t Ä‘áº§u tá»« viá»‡c nháº­n ra mÃ¬nh cáº§n biáº¿t thÃªm. MÃ¬nh á»Ÿ Ä‘Ã¢y Ä‘á»ƒ giÃºp báº¡n báº¯t Ä‘áº§u tá»« nhá»¯ng bÆ°á»›c Ä‘áº§u tiÃªn phÃ¹ há»£p vá»›i tÃ¬nh tráº¡ng sá»©c khoáº» cá»§a báº¡n nháº¥t, tá»‘i Æ°u thá»i gian báº¡n cÃ³ trong quÃ¡ trÃ¬nh mang thai nháº¥t.<br><br>
    `;
  }

  let endFinalMessage = `
    <strong>ğŸ‘‰ Báº¡n muá»‘n hiá»ƒu rÃµ: "CÆ¡ thá»ƒ mÃ¬nh thá»±c sá»± Ä‘ang cáº§n gÃ¬?"</strong><br><br>
    Chia sáº» email á»Ÿ form dÆ°á»›i Ä‘Ã¢y, mÃ¬nh sáº½ gá»­i báº£n phÃ¢n tÃ­ch chi tiáº¿t dá»±a trÃªn tá»«ng cÃ¢u tráº£ lá»i cá»§a báº¡n trong quiz trong vÃ²ng 2-3 ngÃ y. VÃ¬ mÃ¬nh cáº§n thá»i gian xem cÃ¢u tráº£ lá»i cá»§a báº¡n kÄ©, nÃªn sáº½ máº¥t 2-3 ngÃ y.<br><br>
    <strong>âœ¨ ÄÃ£ cÃ³ nhiá»u máº¹ báº§u nháº­n Ä‘Æ°á»£c phÃ¢n tÃ­ch nÃ y vÃ  nÃ³i: "Giá» mÃ¬nh biáº¿t chÃ­nh xÃ¡c mÃ¬nh cáº§n lÃ m gÃ¬ rá»“i!"</strong><br><br>
    <strong>BONUS:</strong> MÃ¬nh sáº½ gá»­i táº·ng kÃ¨m Mini challenge 3 ngÃ y (má»—i ngÃ y 1 email vá»›i hÆ°á»›ng dáº«n cá»¥ thá»ƒ), giÃºp báº¡n báº¯t Ä‘áº§u káº¿t ná»‘i vá»›i cÆ¡ thá»ƒ trong hÃ nh trÃ¬nh mang báº§u nÃ y hÆ¡n.<br><br>
    Äiá»n email Ä‘á»ƒ nháº­n káº¿t quáº£ phÃ¢n tÃ­ch chi tiáº¿t dÃ nh riÃªng cho báº¡n & email mini challenge.<br>
    <input type="email" id="userEmail" placeholder="Nháº­p email cá»§a báº¡n..." style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px;">
    <div id="emailError" style="color: #721c24; font-size: 14px; margin: 5px 0; display: none;"></div>
    <button type="button" onclick="submitEmail()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 5px; font-weight: bold;">Gá»­i cho mÃ¬nh videos</button>
    <div id="emailSuccess" style="color: #155724; font-size: 14px; margin: 10px 0; display: none;">âœ… Báº¡n hÃ£y Ä‘Ã³n chá» email tá»« mÃ¬nh nhÃ©!</div><br>
    Sau khi Ä‘iá»n, báº¡n sáº½ nháº­n Ä‘Æ°á»£c email confirmation & 1 video hÆ°á»›ng dáº«n táº­p thá»Ÿ 2 phÃºt Ä‘á»ƒ cÃ³ thá»ƒ báº¯t Ä‘áº§u ngay.<br><br>
    HÃ nh trÃ¬nh sinh ná»Ÿ lÃ  1 hÃ nh trÃ¬nh thiÃªng liÃªng. NÃ³ khÃ´ng chá»‰ sinh con mÃ  cÃ²n sinh ra nhá»¯ng bÃ  máº¹ máº¡nh máº½, tá»± chá»§ vÃ  biáº¿t cÃ¡ch láº¯ng nghe báº£n thÃ¢n.<br><br>
    ThÃ¢n,<br><br>
    Linh<br>
  `;

  // Calculate max possible score dynamically
  const maxPossibleScore = quizQuestions.reduce((total, question) => {
    const maxScoreForQuestion = Math.max(...question.options.map(option => option.score));
    return total + maxScoreForQuestion;
  }, 0);

  // Calculate score as percentage
  const scorePercentage = Math.round((totalScore / maxPossibleScore) * 100);

  finalScore.innerHTML = `
    <h3>Káº¾T QUáº¢ ÄÃNH GIÃ Cá»¦A Báº N: ${scorePercentage}%</h3>
    <div>${scoreMessage}</div>
    <div>${endFinalMessage}</div>
  `;

  resultsDiv.style.display = 'block';
}

async function sendResultsToGoogleSheets() {
  const maxPossibleScore = quizQuestions.reduce((total, question) => {
    const maxScoreForQuestion = Math.max(...question.options.map(option => option.score));
    return total + maxScoreForQuestion;
  }, 0);

  const resultsData = {
    timestamp: new Date().toISOString(),
    totalQuestions: totalQuestions,
    totalScore: totalScore,
    maxPossibleScore: maxPossibleScore,
    answers: answers || {}
  };

  try {
    const response = await fetch(GOOGLE_SCRIPT_URL, {
      redirect: 'follow',
      method: 'POST',
      headers: {
        'Content-Type': 'text/plain;charset=utf-8',
      },
      body: JSON.stringify(resultsData)
    });

    if (response.ok) {
      const result = await response.json();
      console.log('Success:', result);

      const statusDiv = document.createElement('div');
      document.getElementById('results').appendChild(statusDiv);
    } else {
      throw new Error('Network response was not ok');
    }
  } catch (error) {
    console.error('Error:', error);
    // Handle error appropriately
  }
}

function retryQuiz() {
  initializeQuiz();
}

// Email validation and submission function
function submitEmail() {
  const emailInput = document.getElementById('userEmail');
  const emailError = document.getElementById('emailError');
  const emailSuccess = document.getElementById('emailSuccess');
  const email = emailInput.value.trim();

  // Hide previous messages
  emailError.style.display = 'none';
  emailSuccess.style.display = 'none';

  // Simple email validation regex
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  if (!email) {
    emailError.textContent = 'Vui lÃ²ng nháº­p email cá»§a báº¡n.';
    emailError.style.display = 'block';
    return;
  }

  if (!emailRegex.test(email)) {
    emailError.textContent = 'Vui lÃ²ng nháº­p má»™t Ä‘á»‹a chá»‰ email há»£p lá»‡.';
    emailError.style.display = 'block';
    return;
  }

  // Add email to answers object
  answers.userEmail = {
    email: email,
    submittedAt: new Date().toISOString()
  };

  // Show success message
  emailSuccess.style.display = 'block';

  // Disable the input and button
  emailInput.disabled = true;
  emailInput.style.backgroundColor = '#f8f9fa';
  const button = emailInput.nextElementSibling.nextElementSibling; // Get the button after error div
  button.disabled = true;
  button.textContent = 'ÄÃ£ ghi nháº­n email';
  button.style.backgroundColor = '#6c757d';

  console.log('Email recorded:', email);
  console.log('Updated answers:', answers);

  // Send results to Google Sheets
  sendResultsToGoogleSheets();
}

// Initialize quiz when page loads
window.addEventListener('load', initializeQuiz);
</script>
